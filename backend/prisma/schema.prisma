generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Status {
  pending
  ongoing
  completed
}

enum CardValues {
  shrek
  fiona
  donkey
  puss
  dragon
  waffles
  onions
  farquaad
  fairyGodmother
  princeCharming
  gingy
  humanShrek
  humanFiona
  horseDonkey
  pinocchio
  blindMice
  bigBadWolf
  farFarAway
  fionaCastle
  swamp
  duloc
}

model User {
  id       Int     @id @default(autoincrement())
  username String  @unique
  password String
  matches  Match[] @relation("matches")
}

model Card {
  id      Int        @id @default(autoincrement())
  value   CardValues
  matched Boolean    @default(false)
  matchId Int
  Match   Match      @relation("matchMap", fields: [matchId], references: [id], onDelete: Cascade)
  order   Int
}

model Match {
  id          Int    @id @default(autoincrement())
  players     User[] @relation("matches")
  winnerId    Int?
  map         Card[] @relation("matchMap") // 4x5 grid
  scores      Int[]
  status      Status @default(pending)
  currentTurn Int    @default(0)
  card1Flip   Int?
  card2Flip   Int?
}
